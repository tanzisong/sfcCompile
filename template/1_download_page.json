{"id":"1_download_page","name":"下载-001","components":{"layout_3":{"props":{"appInfo":{},"page":""},"data":{"exchange_icon":"https://sf3-ttcdn-tos.pstatp.com/obj/unity/images/feed-mix-card/exchange.png","delayTime":"300ms","exchangeTimer":null,"exchangeShowStyle":{"transform":"rotate(-90deg)","animationName":"ExchangeShowAnimate","animationDelay":"210ms"},"exchangeHideStyle":{"transform":"rotate(0deg)","animationName":"ExchangeHideAnimate","animationDelay":"0ms"},"exchangeInitStyle":{"transform":"rotate(-90deg)"},"exchangeAnimateStyle":{"transform":"rotate(-90deg)"},"buttonShowStyle":{"opacity":"0","transform":"translateY(-22px)","animationName":"ButtonShowAnimate","animationDelay":"280ms","animationDuration":"500ms","animationFillMode":"forwards","animationTimingFunction":"cubic-bezier(.4, 0, .2, 1)"},"buttonHideStyle":{"opacity":1,"transform":"translateY(0px)","animationName":"ButtonHideAnimate","animationDelay":"0ms","animationDuration":"500ms","animationFillMode":"forwards","animationTimingFunction":"cubic-bezier(.4, 0, .2, 1)"},"buttonInitStyle":{"opacity":"0"},"buttonAnimateStyle":{"opacity":"0"},"cardShowStyle":{"opacity":"0","transform":"translateY(-22px)","animationName":"CardShowAnimate","animationDelay":"210ms"},"cardHideStyle":{"opacity":1,"transform":"translateY(0)","animationName":"CardHideAnimate","animationDelay":"70ms"},"cardInitStyle":{"opacity":"0"},"cardAnimateStyle":{"opacity":"0"},"componentShowTime":""},"lifetimes":{"load":{"__TYPE__":4,"code":"function(){\n        this.methods.callJSB(\"cardStatus\", {data: {status: 1}}, function(res){console.info('cardStatus', res)});\n         var { device_platform } = this.props.appInfo;\n        console.info(\"device_platform\", device_platform)\n        if(device_platform !== 'android') {\n          this.methods.setData({\n            delayTime: \"210ms\"\n          });\n        }\n      }"}},"event":{"feedButtonStartUnfold":{"__TYPE__":4,"code":"\n         function() {\n            console.info(\"feedButtonStartUnfold事件回调\");\n            this.methods.setData({\n              exchangeAnimateStyle: this.data.exchangeShowStyle,\n              buttonAnimateStyle: this.data.buttonShowStyle,\n              cardAnimateStyle: this.data.cardShowStyle,\n              componentShowTime: this.data.componentShowTime ? this.data.componentShowTime : new Date().getTime()\n            })\n         }\n      "}},"methods":{"onClick":{"__TYPE__":4,"code":"\n        function(refer, click_type) {\n          if(!click_type) {\n            click_type = ''\n          }\n        \n          var _this = this;\n           this.methods.callJSB(\"getVideoShowTime\", {}, function (res) {\n            var show_time = res.data.show_time;\n          \n            var click_time = (\n              new Date().getTime() - _this.data.componentShowTime\n            ).toString();\n          \n            console.info(\n              \"show_time, click_time, refer, click_type\",\n              show_time,\n              click_time,\n              refer,\n              click_type\n            );\n          \n             _this.methods.callJSB(\n              \"feedLearnMoreButtonClick\",\n              {\n                data: {\n                  refer: refer,\n                  click_type: click_type,\n                  type:\n                     _this.data.__globalProps.lynx_raw_data.template_type === 5\n                      ? \"app\"\n                      : \"business\",\n                  template_type:  _this.data.__globalProps.lynx_raw_data.template_type,\n                  ad_extra_data: {\n                    show_time: show_time,\n                    click_time: click_time\n                  }\n                }\n              },\n              function (res) {}\n            );\n          });\n        }\n      "},"inSightSdkClick":{"__TYPE__":4,"code":"\n        function(event) {\n            if(this.methods.eventEmitter && this.methods.eventEmitter.emitClickEvent) {\n               var { x, y } = event.detail || {};\n              console.info('x, y', x, y);\n              this.methods.eventEmitter.emitClickEvent({\n                x: x,\n                y: y,\n                clientX: x,\n                clientY: y,\n              })\n            }\n        }\n      "},"startHideAnimate":{"__TYPE__":4,"code":"\n        function() {\n          console.info('隐藏页面->执行隐藏动画');\n          this.methods.setData({\n            exchangeAnimateStyle: this.data.exchangeHideStyle,\n            buttonAnimateStyle: this.data.buttonHideStyle,\n            cardAnimateStyle: this.data.cardHideStyle\n          });\n        }\n      "}},"slots":{"thumb":[{"id":"","name":"view","style":{"width":"100%","height":"100%","borderRadius":"8px","backgroundColor":"#DDDDDD"}}],"title":[{"id":"","name":"view","style":{"width":"100%","height":"22px","borderRadius":"4px","backgroundColor":"#DDDDDD"}}],"button":[{"id":"","name":"view","style":{"width":"100%","height":"100%","borderRadius":"4px","backgroundColor":"#DDDDDD"}}],"desc":[{"id":"","name":"view","style":{"width":"100%","height":"100%","borderRadius":"4px","backgroundColor":"#DDDDDD"}}]},"content":{"id":"","name":"view","style":{"position":"relative","display":"flex","flexDirection":"column","justifyContent":"space-between","width":"100vw","maxWidth":"268px","height":"144px","margin":"35px 0px 0px 0px","overflow":"visible"},"event":{"click":{"__TYPE__":4,"code":"\n        function(e) {this.methods.onClick.call(this, 'blank'); this.methods.inSightSdkClick.call(this, e)\n        this.methods.bridges.sendCustomLog({\n            label: \"blank\",\n            extra: {\n              page: this.props.page,\n            },\n          });\n        }"}},"props":{"name":"nativeNotResponseRootView"},"children":[{"id":"","name":"view","style":{"__TYPE__":4,"code":"Object.assign({display: 'flex', flexDirection: 'row', width: '100%', height: '64px'}, this.data.buttonAnimateStyle)"},"children":[{"id":"","name":"slot","style":{"flexShrink":0,"width":"64px","height":"64px","overflow":"hidden"},"event":{"click":{"__TYPE__":4,"code":"function(e) {this.methods.onClick.call(this, 'photo'); this.methods.inSightSdkClick.call(this, e);\n                this.methods.bridges.sendCustomLog({\n                  label: \"photo\",\n                  extra: {\n                    page: this.props.page,\n                  },\n                });\n                }"}},"props":{"slotName":"thumb"}},{"id":"","name":"view","style":{"display":"flex","flexDirection":"column","justifyContent":"space-between","flexGrow":1,"width":"0px","height":"64px","margin":"0px 0px 0px 8px","padding":"2px 0px 0px 0px"},"children":[{"id":"","name":"view","style":{"display":"flex","flexDirection":"row","alignItems":"center","width":"100%","height":"22px","overflowY":"visible"},"children":[{"id":"","name":"slot","style":{"flexGrow":1,"width":"0px","height":"22px","overflowY":"visible"},"event":{"click":{"__TYPE__":4,"code":"function(e) {this.methods.onClick.call(this, 'title'); this.methods.inSightSdkClick.call(this, e);\n                        this.methods.bridges.sendCustomLog({\n                          label: \"title\",\n                          extra: {\n                            page: this.props.page,\n                          },\n                        });\n                        }"}},"props":{"slotName":"title"}},{"id":"view-container","name":"view","style":{"padding":"3px","width":"24px","height":"24px","alignSelf":"center"},"event":{"click":{"__TYPE__":4,"code":"\n                          function click(e) {\n                            if (!this.data.exchangeTimer) {\n                              var _this = this;\n                               var timer =  this.methods.setTimeout(function () {\n                                 _this.methods.callJSB(\n                                  \"startFoldButton\",\n                                  {\n                                    data: {\n                                      animate_delay: 460\n                                    }\n                                  },\n                                  function () {\n                                     _this.methods.setData({\n                                      exchangeTimer: null\n                                    });\n                                  }\n                                );\n                              }, 120);\n\n                              \n                              console.info('隐藏页面->执行隐藏动画');\n                              this.methods.startHideAnimate.call(this);\n                              this.methods.bridges.sendAdLog({\n                                  data: {\n                                    tag: 'draw_ad',\n                                    label: 'otherclick',\n                                    extParam: {\n                                      refer: 'change',\n                                    },\n                                  }\n                                });\n                                this.methods.bridges.sendCustomLog({\n                                  label: \"change\",\n                                  extra: {\n                                    page: this.props.page,\n                                  },\n                                });\n                              \n                               this.methods.setTimeout(function () {\n                                 _this.methods.setData({\n                                  exchangeTimer: timer\n                                });\n                              }, 0);\n\n                              \n                              this.methods.inSightSdkClick.call(this, e);\n                            }\n                          }\n                        "}},"children":[{"id":"image_1","name":"image","style":{"__TYPE__":4,"code":"Object.assign({width: '100%', height: '100%', animationFillMode: 'forwards', animationDuration: '380ms', animationTimingFunction: \"cubic-bezier(.4, 0, .2, 1)\",}, this.data.exchangeAnimateStyle)"},"props":{"src":{"__TYPE__":1,"path":["exchange_icon"]}}}]}]},{"id":"","name":"slot","$if":{"__TYPE__":4,"code":"this.props.appInfo.device_platform === 'iphone'"},"style":{"width":"100%","height":"32px"},"event":{"click":{"__TYPE__":4,"code":"function(e) {this.methods.onClick.call(this, 'button', 'action'); this.methods.inSightSdkClick.call(this, e)\n                     this.methods.bridges.sendCustomLog({\n                      label: \"button\",\n                      extra: {\n                        page: this.props.page,\n                      },\n                    });\n                    }"}},"props":{"slotName":"button"}},{"id":"","name":"slot","$if":{"__TYPE__":4,"code":"this.props.appInfo.device_platform !== 'iphone'"},"style":{"width":"100%","height":"32px"},"props":{"slotName":"button"}}]}]},{"id":"","name":"view","style":{"__TYPE__":4,"code":"Object.assign({width: '100%', height: '72px', padding: '14px 6px', backgroundColor: 'rgba(0, 0, 0, 0.34)', borderRadius: '4px', animationDuration: '500ms', animationTimingFunction: 'cubic-bezier(.4, 0, .2, 1)', animationFillMode: \"forwards\"}, this.data.cardAnimateStyle)"},"event":{"click":{"__TYPE__":4,"code":"function(e) {this.methods.onClick.call(this, 'support_area'); this.methods.inSightSdkClick.call(this, e)\n            this.methods.bridges.sendCustomLog({\n                label: \"support_area\",\n                extra: {\n                  page: this.props.page,\n                },\n              });\n            }"}},"children":[{"id":"","name":"slot","style":{"flexGrow":1,"width":"100%","height":"48px"},"props":{"slotName":"desc"}}]}]}},"thumb":{"props":{"src":""},"content":{"id":"thumb-image","name":"image","style":{"width":"64px","height":"64px","borderRadius":"8px"},"props":{"src":{"__TYPE__":1,"path":["src"]}}}},"title":{"props":{"innerText":"","maxLine":1},"content":{"id":"title-text","name":"text","style":{"fontWeight":"500","fontSize":"16px","lineHeight":"22px","fontStyle":"normal","color":"rgba(255, 255, 255, 1)","textShadow":"0px 0px 8px rgba(0,0,0,0.5)","overflow":"visible"},"props":{"innerText":{"__TYPE__":1,"path":["innerText"]},"textMaxLine":{"__TYPE__":1,"path":["maxLine"]}}}},"downloadButton":{"data":{"is_iphone":true,"statusIcon":{"0":"https://sf3-ttcdn-tos.pstatp.com/obj/unity/images/feed-mix-card/download.png","3":"https://sf3-ttcdn-tos.pstatp.com/obj/unity/images/feed-mix-card/pause.png","4":"https://sf3-ttcdn-tos.pstatp.com/obj/unity/images/feed-mix-card/complete.png"},"statusText":{"idleText":"立即下载","pausedText":"继续下载","finishedText":"立即安装","installedText":"立即打开"},"DownloadStatus":{"ready":0,"fail":1,"ing":2,"paused":3,"finished":4},"DOWNLOAD_STATUS":{"IDLE":"idle","CANCEL":"cancel_download","DOWNLOADING":"download_active","PAUSED":"download_paused","FAIL":"download_failed","FINISHED":"download_finished","INSTALLED":"installed","UNSUBSCRIBED":"unsubscribed"},"buttonData":{"icon":"https://sf3-ttcdn-tos.pstatp.com/obj/unity/images/feed-mix-card/download.png","text":"立即下载","process":0,"isDownloading":false,"isPaused":false,"status":0},"defaultBg":"#008DEA"},"props":{"button_text":"立即下载","button_background_color":"","appData":{},"adInfo":{},"open_url":"","appInfo":{}},"event":{"app_ad_event":{"__TYPE__":4,"code":"\n        function(data) {\n          console.info('安卓下载数据', data);\n          if(data.data) {\n             var { current_bytes = 0, total_bytes = 0, status } = data.data;\n             var newButtonData = {\n              icon: this.data.statusIcon['0'],\n              text: this.data.statusText.idleText,\n              process: 0,\n              isDownloading: false,\n              isPaused: false,\n              status: 0,\n            };\n             var progress = +total_bytes > 0 ? Math.ceil((+current_bytes * 100) / +total_bytes) : 0;\n            switch (status) {\n              case this.data.DOWNLOAD_STATUS.CANCEL:\n              case this.data.DOWNLOAD_STATUS.FAIL:\n              case this.data.DOWNLOAD_STATUS.IDLE:\n            case this.data.DOWNLOAD_STATUS.UNSUBSCRIBED:\n                // 取消/未下载/失败\n                newButtonData.isDownloading = false;\n                newButtonData.text = this.data.statusText.idleText;\n                newButtonData.icon = this.data.statusIcon['0'];\n                newButtonData.status = this.data.DownloadStatus.fail;\n                break;\n            case this.data.DOWNLOAD_STATUS.DOWNLOADING:\n             // 下载中\n              newButtonData.isDownloading = true;\n              newButtonData.isPaused = false;\n              newButtonData.process = progress;\n              newButtonData.status = this.data.DownloadStatus.ing;\n              break;\n            case this.data.DOWNLOAD_STATUS.PAUSED:\n              // 暂停\n              newButtonData.isDownloading = true;\n              newButtonData.isPaused = true;\n              newButtonData.process = progress;\n              newButtonData.text = this.data.statusText.pausedText;\n              newButtonData.icon = this.data.statusIcon['3'];\n              newButtonData.status = this.data.DownloadStatus.paused;\n              break;\n            case this.data.DOWNLOAD_STATUS.FINISHED:\n            // 下载完成\n              newButtonData.isDownloading = false;\n              newButtonData.text = this.data.statusText.finishedText;\n              newButtonData.icon = this.data.statusIcon['4'];\n              newButtonData.status = this.data.DownloadStatus.finished;\n              newButtonData.process = progress;\n              break;\n            case this.data.DOWNLOAD_STATUS.INSTALLED:\n            // 安装完成\n              newButtonData.isDownloading = false;\n              newButtonData.text = this.data.statusText.installedText;\n              newButtonData.icon = this.data.statusIcon['4'];\n              newButtonData.status = this.data.DownloadStatus.finished;\n              newButtonData.process = progress;\n              break;\n            }\n            console.info('newButtonData', newButtonData);\n              this.methods.setData({\n              buttonData: newButtonData\n              })\n          }\n        }\n      "}},"lifetimes":{"load":{"__TYPE__":4,"code":"\n        function() {\n          console.info(\"this.props.appInfo\", this.props.appInfo);\n          if(this.props.appInfo.device_platform === 'android') {\n            this.methods.setData({\n              is_iphone: false\n            })\n            console.info('安卓下载类, 初始化下载逻辑');\n             var open_url = undefined;\n             var aid = this.props.appInfo.aid;\n            if(this.props.open_url && typeof this.props.open_url === 'string') {\n              this.props.open_url.replace('__back_url__', \"snssdk\"+aid+\"%3A%2F%2Fadx\");\n            }\n\n            var downLoadAppData = Object.assign({open_url, click_track_url_list: this.props.adInfo.track_url_list}, this.props.appData)\n            console.info('downLoadAppData', downLoadAppData)\n            this.methods.callJSB(\"subscribe_app_ad\", { data: {data: this.props.appData} },function () {});\n        }\n      }\n      "}},"methods":{"inSightSdkClick":{"__TYPE__":4,"code":"\n        function(event) {\n            if(this.methods.eventEmitter && this.methods.eventEmitter.emitClickEvent) {\n               var { x, y } = event.detail || {};\n              console.info('x, y', x, y);\n              this.methods.eventEmitter.emitClickEvent({\n                x: x,\n                y: y,\n                clientX: x,\n                clientY: y,\n              })\n            }\n        }\n      "},"changeBg":{"__TYPE__":4,"code":"\n        function(){\n           var { status } = this.methods.getData('buttonData');\n           var bg = this.props.button_background_color || this.data.defaultBg;\n           var DownloadStatus = this.methods.getData('DownloadStatus');\n          \n          switch (status) {\n            case DownloadStatus.ready:\n            case DownloadStatus.fail:\n              bg = this.props.button_background_color || this.data.defaultBg;\n              break;\n            case DownloadStatus.ing:\n            case DownloadStatus.paused:\n              bg = 'transparent';\n              break;\n            case DownloadStatus.finished:\n              bg = this.props.button_background_color || this.data.defaultBg;\n              break;\n            }\n            return bg;\n        }\n      "}},"content":{"id":"download-button","name":"view","event":{},"style":{"position":"relative","width":"100%","height":"100%"},"children":[{"id":"iphone-lynx-download","name":"view","$if":{"__TYPE__":4,"code":"this.data.is_iphone"},"style":{"height":"100%","width":"100%","alignItems":"center","justifyContent":"center","transition":"background-color 300ms 0ms cubic-bezier(.42,0,.58,1)","borderRadius":"4px","backgroundColor":{"__TYPE__":4,"code":"function(){\n              if(this.props.button_background_color) {\n                return this.props.button_background_color;\n              }\n              return this.data.defaultBg\n            }.call(this)"}},"children":[{"id":"ready-download","name":"view","style":{"alignItems":"center"},"children":[{"id":"ready-download-image","name":"image","style":{"width":"16px","height":"16px","margin":"0px 5px 0px 0px"},"props":{"src":{"__TYPE__":1,"path":["statusIcon","0"]}}},{"id":"download-text-iphone","name":"text","style":{"fontFamily":"PingFang SC","fontStyle":"normal","fontWeight":"500","fontSize":"13px","lineHeight":"18px","color":"#FFFFFF"},"props":{"innerText":{"__TYPE__":1,"path":["button_text"]}}}]}]},{"id":"android-lynx-industry-download","name":"view","style":{"height":"100%","width":"100%","alignItems":"center","justifyContent":"center","transition":"background-color 300ms 0ms cubic-bezier(.42,0,.58,1)","borderRadius":"4px","backgroundColor":{"__TYPE__":4,"code":"this.methods.changeBg.bind(this)()"}},"$if":{"__TYPE__":4,"code":"!this.data.is_iphone"},"event":{"click":{"__TYPE__":4,"code":"\n              function(e) {\n                 var open_url = undefined;\n                 var aid = this.props.appInfo.aid;\n                if(this.props.open_url && typeof this.props.open_url === 'string') {\n                  this.props.open_url.replace('__back_url__', \"snssdk\"+aid+\"%3A%2F%2Fadx\");\n                }\n  \n                var downLoadAppData = Object.assign({open_url, click_track_url_list: this.props.adInfo.track_url_list}, this.props.appData)\n                \n                this.methods.callJSB(\"download_app_ad\", {data: {data: Object.assign(downLoadAppData, {extParam: {ad_extra_data: {click_type: 'action',}, refer: 'button',},})}}, function(res){console.info(\"download_app_ad_call_res\", res);});\n                \n                this.methods.inSightSdkClick.call(this, e)\n              }\n            "}},"children":[{"id":"ready-over-download","name":"view","$if":{"__TYPE__":4,"code":"!this.data.buttonData.isDownloading"},"style":{"borderRadius":"2px","position":"relative","overflow":"hidden","width":"100%","height":"100%","backgroundColor":"rgba(255, 255, 255, 0.15)"},"children":[{"id":"progress-bar-view","name":"view","style":{"width":{"__TYPE__":4,"code":"this.data.buttonData.process + '%'"},"backgroundColor":"rgba(255, 255, 255, 0.15)","borderTopLeftRadius":"2px","borderBottomLeftRadius":"2px","height":"100%","position":"absolute"}},{"id":"view-text-icon","name":"view","style":{"alignSelf":"center","margin":"0 auto"},"props":{"name":"view-text-icon"},"children":[{"id":"ready-download","name":"image","style":{"width":"16px","height":"16px","margin":"0px 5px 0px 0px","alignSelf":"center"},"props":{"src":{"__TYPE__":1,"path":["buttonData","icon"]}}},{"id":"download-text","name":"text","style":{"fontSize":"13px","color":"#FFFFFF","fontWeight":500},"props":{"innerText":{"__TYPE__":1,"path":["buttonData","text"]}}}]}]},{"id":"mul-download-status","name":"view","$if":{"__TYPE__":4,"code":"this.data.buttonData.isDownloading"},"style":{"backgroundColor":"rgba(255, 255, 255, 0.15)","borderRadius":"2px","position":"relative","overflow":"hidden","width":"100%","height":"100%"},"children":[{"id":"progress-bar-view","name":"view","style":{"width":{"__TYPE__":4,"code":"this.data.buttonData.process + '%'"},"backgroundColor":"rgba(255, 255, 255, 0.15)","borderTopLeftRadius":"2px","borderBottomLeftRadius":"2px","height":"100%","position":"absolute"}},{"id":"view-text-icon","name":"view","style":{"alignSelf":"center","margin":"0 auto"},"children":[{"id":"ready-download","name":"image","$if":{"__TYPE__":4,"code":"this.data.buttonData.isPaused"},"style":{"width":"16px","height":"16px","margin":"0px 5px 0px 0px","alignSelf":"center"},"props":{"src":{"__TYPE__":1,"path":["buttonData","icon"]}}},{"id":"download-pause","name":"text","$if":{"__TYPE__":4,"code":"this.data.buttonData.isPaused"},"style":{"fontSize":"13px","color":"#FFFFFF","fontWeight":500},"props":{"innerText":{"__TYPE__":1,"path":["buttonData","text"]}}},{"id":"download-ing","name":"text","$if":{"__TYPE__":4,"code":"!this.data.buttonData.isPaused"},"style":{"fontSize":"13px","color":"#FFFFFF","fontWeight":500},"props":{"innerText":{"__TYPE__":4,"code":"'正在下载  '+this.data.buttonData.process + \"%\""}}}]}]}]}]}},"tag":{"props":{"color":"#FF6238","backgroundColor":"rgba(22, 24, 35, 0.34)","size":193,"tags":[],"fontWeight":"normal"},"methods":{"adjust":{"__TYPE__":4,"code":"function(tags, maxWidth) {\n function _toConsumableArray(arr) {\n  return (\n   _arrayWithoutHoles(arr) ||\n   _iterableToArray(arr) ||\n   _unsupportedIterableToArray(arr) ||\n   _nonIterableSpread()\n  );\n }\n\n function _nonIterableSpread() {\n  throw new TypeError(\n   \"Invalid attempt to spread non-iterable instance.In order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"\n  );\n }\n\n function _iterableToArray(iter) {\n  if (\n   (typeof Symbol !== \"undefined\" && iter[Symbol.iterator] != null) ||\n   iter[\"@@iterator\"] != null\n  )\n   return Array.from(iter);\n }\n\n function _arrayWithoutHoles(arr) {\n  if (Array.isArray(arr)) return _arrayLikeToArray(arr);\n }\n\n function _slicedToArray(arr, i) {\n  return (\n   _arrayWithHoles(arr) ||\n   _iterableToArrayLimit(arr, i) ||\n   _unsupportedIterableToArray(arr, i) ||\n   _nonIterableRest()\n  );\n }\n\n function _nonIterableRest() {\n  throw new TypeError(\n   \"Invalid attempt to destructure non-iterable instance.In order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"\n  );\n }\n\n function _iterableToArrayLimit(arr, i) {\n  var _i =\n   arr == null\n    ? null\n    : (typeof Symbol !== \"undefined\" && arr[Symbol.iterator]) ||\n    arr[\"@@iterator\"];\n  if (_i == null) return;\n  var _arr = [];\n  var _n = true;\n  var _d = false;\n  var _s, _e;\n  try {\n   for (_i = _i.call(arr); !(_n = (_s = _i.next()).done); _n = true) {\n    _arr.push(_s.value);\n    if (i && _arr.length === i) break;\n   }\n  } catch (err) {\n   _d = true;\n   _e = err;\n  } finally {\n   try {\n    if (!_n && _i[\"return\"] != null) _i[\"return\"]();\n   } finally {\n    if (_d) throw _e;\n   }\n  }\n  return _arr;\n }\n\n function _arrayWithHoles(arr) {\n  if (Array.isArray(arr)) return arr;\n }\n\n function _createForOfIteratorHelper(o, allowArrayLike) {\n  var it =\n   (typeof Symbol !== \"undefined\" && o[Symbol.iterator]) || o[\"@@iterator\"];\n  if (!it) {\n   if (\n    Array.isArray(o) ||\n    (it = _unsupportedIterableToArray(o)) ||\n    (allowArrayLike && o && typeof o.length === \"number\")\n   ) {\n    if (it) o = it;\n    var i = 0;\n    var F = function F() {};\n    return {\n     s: F,\n     n: function n() {\n      if (i >= o.length) return { done: true };\n      return { done: false, value: o[i++] };\n     },\n     e: function e(_e2) {\n      throw _e2;\n     },\n     f: F\n    };\n   }\n   throw new TypeError(\n    \"Invalid attempt to iterate non-iterable instance.In order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"\n   );\n  }\n  var normalCompletion = true,\n   didErr = false,\n   err;\n  return {\n   s: function s() {\n    it = it.call(o);\n   },\n   n: function n() {\n    var step = it.next();\n    normalCompletion = step.done;\n    return step;\n   },\n   e: function e(_e3) {\n    didErr = true;\n    err = _e3;\n   },\n   f: function f() {\n    try {\n     if (!normalCompletion && it.return != null) it.return();\n    } finally {\n     if (didErr) throw err;\n    }\n   }\n  };\n }\n\n function _unsupportedIterableToArray(o, minLen) {\n  if (!o) return;\n  if (typeof o === \"string\") return _arrayLikeToArray(o, minLen);\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n  if (n === \"Object\" && o.constructor) n = o.constructor.name;\n  if (n === \"Map\" || n === \"Set\") return Array.from(o);\n  if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))\n   return _arrayLikeToArray(o, minLen);\n }\n\n function _arrayLikeToArray(arr, len) {\n  if (len == null || len > arr.length) len = arr.length;\n  for (var i = 0, arr2 = new Array(len); i < len; i++) {\n   arr2[i] = arr[i];\n  }\n  return arr2;\n }\n\n function main(tags, maxWidth) {\n  if (!tags) {\n   tags = [];\n  }\n\n  if (maxWidth === undefined) {\n   maxWidth = 0;\n  }\n\n  var minLength = 2;\n  var maxLength = 5;\n  var map = new Map();\n\n  var _iterator = _createForOfIteratorHelper(tags),\n   _step;\n\n  try {\n   for (_iterator.s(); !(_step = _iterator.n()).done; ) {\n    var tag = _step.value;\n\n    if (\n     typeof tag === \"string\" &&\n     tag.length >= minLength &&\n     tag.length <= maxLength\n    ) {\n     if (map.has(tag.length)) {\n      map.set(\n       tag.length,\n       [].concat(_toConsumableArray(map.get(tag.length)), [tag])\n      );\n     } else {\n      map.set(tag.length, [tag]);\n     }\n    }\n   }\n  } catch (err) {\n   _iterator.e(err);\n  } finally {\n   _iterator.f();\n  }\n\n  var calcWidth = function calcWidth() {\n   var map =\n    arguments.length > 0 && arguments[0] !== undefined\n     ? arguments[0]\n     : new Map();\n   var width = 0;\n\n   var _iterator2 = _createForOfIteratorHelper(map.entries()),\n    _step2;\n\n   try {\n    for (_iterator2.s(); !(_step2 = _iterator2.n()).done; ) {\n     var _step2$value = _slicedToArray(_step2.value, 2),\n      k = _step2$value[0],\n      v = _step2$value[1];\n\n     width += v.reduce(function (sum, tag) {\n      return sum + k * 11 + 8 + 4;\n     }, 0);\n    }\n   } catch (err) {\n    _iterator2.e(err);\n   } finally {\n    _iterator2.f();\n   }\n\n   return width;\n  };\n\n  while (calcWidth(map) > maxWidth + 4) {\n   var minKey = Math.min.apply(Math, _toConsumableArray(map.keys()));\n   var minValue = map.get(minKey);\n\n   if (minValue.length > 1) {\n    map.set(minKey, minValue.slice(1));\n   } else {\n    map.delete(minKey);\n   }\n  }\n\n  var legalTags = [];\n\n  var _iterator3 = _createForOfIteratorHelper(map.values()),\n   _step3;\n\n  try {\n   for (_iterator3.s(); !(_step3 = _iterator3.n()).done; ) {\n    var v = _step3.value;\n    legalTags.push.apply(legalTags, _toConsumableArray(v));\n   }\n  } catch (err) {\n   _iterator3.e(err);\n  } finally {\n   _iterator3.f();\n  }\n\n  return legalTags;\n }\nconsole.info('tags, maxWidth', tags, maxWidth);\n return main(tags, maxWidth);\n}"}},"content":{"id":"","name":"view","style":{"width":{"__TYPE__":4,"code":"`${this.props.size}px`"},"height":"16px","padding":"0px -2px","overflow":"visible"},"children":[{"id":"","name":"view","style":{"display":"flex","alignItems":"center","flexShrink":0,"justifyContent":"center","height":"16px","margin":"0px 2px","padding":"0px 4px","backgroundColor":{"__TYPE__":1,"path":["backgroundColor"]},"borderRadius":"2px","overflow":"visible"},"$for":{"data":{"__TYPE__":4,"code":"this.methods.adjust.call(this, this.props.tags, this.props.size)"}},"children":[{"id":"","name":"text","style":{"fontSize":"10px","fontStyle":"normal","fontWeight":{"__TYPE__":1,"path":["fontWeight"]},"lineHeight":"14px","whiteSpace":"nowrap","color":{"__TYPE__":4,"code":"this.props.color"}},"props":{"innerText":{"__TYPE__":1,"path":["item"]}}}]}]}},"praise":{"props":{"star":{"gray":"https://sf3-ttcdn-tos.pstatp.com/obj/unity/images/feed-mix-card/star_gray_1.png","light":"https://sf3-ttcdn-tos.pstatp.com/obj/unity/images/feed-mix-card/star_light.png","half":"https://sf3-ttcdn-tos.pstatp.com/obj/unity/images/feed-mix-card/star_half.png"},"score":"","size":16},"content":{"id":"praise","name":"view","event":{},"style":{"overflow":"visible"},"children":[{"id":"outer-container-view","name":"view","$if":{"__TYPE__":4,"code":"this.props.score !== 0 && this.props.score !== '0'"},"style":{"height":{"__TYPE__":4,"code":"this.props.size + 'px'"},"display":"flex","flexDirection":"row","alignItems":"center"},"children":[{"id":"start-png","name":"image","$for":{"data":{"__TYPE__":4,"code":"[0, 1, 2, 3, 4]"},"item":"startItem"},"style":{"width":{"__TYPE__":4,"code":"this.props.size + 'px'"},"height":{"__TYPE__":4,"code":"this.props.size + 'px'"},"margin":{"__TYPE__":4,"code":"\n                  startItem === 4 ? '0px' : '0px 2.13px 0px 0px'\n                "}},"props":{"src":{"__TYPE__":4,"code":"function() {\n                  const score = this.props.score;\n                  const differ = score - startItem;\n                  return score > startItem ? (differ >=1 ? this.props.star.light : differ > 0.5 ? this.props.star.light: this.props.star.half) : this.props.star.gray;\n                }.bind(this)()"}}}]}]}},"subSlogan":{"props":{"product_slogan":"","maxLine":1},"content":{"id":"title-text","name":"text","style":{"fontSize":"14px","lineHeight":"18px","fontStyle":"normal","color":"rgba(255, 255, 255, 0.9)"},"props":{"innerText":{"__TYPE__":1,"path":["product_slogan"]},"textMaxLine":{"__TYPE__":1,"path":["maxLine"]}}}}},"data":{},"methods":{"ceil":{"__TYPE__":4,"code":"\n        function(score) {\n          console.info('score', score);\n          const length = score.length;\n          if(length <= 3) {\n            return score;\n          }\n          const newScore = String(Number(score.slice(0, 3))+0.1).slice(0, 3);\n          console.info('return score', newScore)\n          return newScore;\n        }\n      "}},"page":{"id":"1","name":"layout_3","style":{},"props":{"appInfo":{"__TYPE__":1,"path":["appInfo"]},"page":"1_download_page"},"slots":{"thumb":[{"id":"thumb","name":"thumb","style":{"width":"100%","height":"100%"},"props":{"src":{"__TYPE__":1,"path":["__globalProps","lynx_raw_data","mixed_area_info","image_url"]}}}],"title":[{"id":"title","name":"title","style":{"overflowY":"visible"},"props":{"innerText":{"__TYPE__":1,"path":["__globalProps","lynx_raw_data","mixed_area_info","product_name"]}}}],"button":[{"id":"action-download-button","name":"downloadButton","style":{"width":"100%","height":"100%"},"props":{"button_background_color":{"__TYPE__":1,"path":["__globalProps","lynx_raw_data","mixed_area_info","button_background_color"]},"button_text":{"__TYPE__":1,"path":["__globalProps","lynx_raw_data","mixed_area_info","button_text"]},"appData":{"__TYPE__":1,"path":["__globalProps","lynx_raw_data","mixed_area_info","app_data"]},"adInfo":{"__TYPE__":1,"path":["adInfo"]},"open_url":{"__TYPE__":1,"path":["__globalProps","lynx_raw_data","open_url"]},"appInfo":{"__TYPE__":1,"path":["appInfo"]}}}],"desc":[{"id":"left-label-view","name":"view","style":{"width":"57px","height":"40px","justifyContent":"space-between","flexDirection":"column","overflow":"visible"},"children":[{"id":"view-text","name":"view","style":{"justifyContent":"center"},"children":[{"id":"pingfen","name":"text","style":{"margin":"0px 2px 4px 0px","fontSize":"10px","fontWeight":500,"lineHeight":"14px","color":"rgba(255, 255, 255, 0.75)","alignSelf":"flex-end"},"props":{"innerText":"评分"}},{"id":"score","name":"text","style":{"fontStyle":"normal","fontWeight":"bold","fontSize":"22px","lineHeight":"26px","color":"rgba(255, 255, 255, 0.9)"},"props":{"innerText":{"__TYPE__":4,"code":"this.methods.ceil(this.data.__globalProps.lynx_raw_data.mixed_area_info.app_like)"}}}]},{"id":"praise","name":"praise","style":{"overflow":"visible","justifyContent":"center"},"props":{"size":8,"score":{"__TYPE__":4,"code":"this.methods.ceil(this.data.__globalProps.lynx_raw_data.mixed_area_info.app_like)"}}}]},{"id":"split-line","name":"view","style":{"width":"1px","height":"56px","margin":"0px 8px 0px 6px","backgroundImage":"linear-gradient(180deg, #FFFFFF 0%, rgba(255, 255, 255, 0) 0.01%, rgba(255, 255, 255, 0.3) 51.79%, rgba(255, 255, 255, 0) 100%)"}},{"id":"","name":"view","style":{"display":"flex","flexDirection":"column","justifyContent":"space-between","flexGrow":1,"width":"0px","height":"42px"},"children":[{"id":"subSlogan","name":"subSlogan","style":{"width":"100%","height":"18px"},"props":{"product_slogan":{"__TYPE__":1,"path":["__globalProps","lynx_raw_data","mixed_area_info","product_slogan"]}}},{"id":"label-view","name":"tag","style":{"width":"100%","height":"auto","minHeight":"16px"},"props":{"color":"rgba(255, 255, 255, 0.75)","backgroundColor":"rgba(255, 255, 255, 0.2)","size":{"__TYPE__":4,"code":"this.data.__globalProps.screenWidth >= 378? 268-84 : 268*this.data.__globalProps.screenWidth/387-84"},"tags":{"__TYPE__":1,"path":["__globalProps","lynx_raw_data","mixed_area_info","product_tags"]}}}]}]}}}
